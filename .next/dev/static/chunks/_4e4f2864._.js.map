{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/rikdewit/code/Miked.app/utils/stageConfig.ts"],"sourcesContent":["import { StageItem } from '../types';\n\n// --- Constants ---\nexport const STAGE_WIDTH = 8; // Wider stage for better spacing\nexport const STAGE_DEPTH = 5; \n\n// --- Color Palette ---\nexport const COLORS = {\n  person: '#3b82f6',     // Blue 500\n  amp: '#1e293b',        // Slate 800\n  drum: '#ef4444',       // Red 500\n  keys: '#8b5cf6',       // Violet 500\n  mic: '#94a3b8',        // Slate 400\n  instrument: '#cbd5e1', // Slate 300 (Lighter Neutral)\n  pedalboard: '#111827', // Gray 900\n  di: '#f97316',         // Orange 500\n  monitor: '#374151',    // Gray 700\n  power: '#eab308',      // Yellow 500\n  stand: '#64748b'       // Slate 500\n};\n\n// --- Item Configuration Helper ---\nexport const getItemConfig = (item: StageItem) => {\n  if (item.type === 'custom') {\n    const w = item.customWidth ?? 0;\n    const d = item.customDepth ?? 0;\n    if (w === 0 && d === 0) {\n      return { width: 0.3, depth: 0.3, height: 0.01, color: 'transparent', shape: 'box' };\n    }\n    return { width: w, depth: d, height: item.customHeight ?? 0.3, color: '#6366f1', shape: 'box' };\n  }\n\n  const isPerson = item.type === 'person';\n  const isMonitor = item.type === 'monitor';\n  const isPower = item.type === 'power';\n  const isStand = item.type === 'stand';\n  const label = (item.label || '').toLowerCase();\n\n  // Specific Item Detection based on labels generated in StepStagePlot\n  if (isPerson) {\n    return { width: 0.5, depth: 0.5, height: 1.7, color: COLORS.person, shape: 'person' };\n  } \n  \n  if (isMonitor) {\n    return { width: 0.6, depth: 0.4, height: 0.3, color: COLORS.monitor, shape: 'wedge' };\n  }\n\n  if (isPower) {\n    return { width: 0.3, depth: 0.3, height: 0.3, color: COLORS.power, shape: 'box' };\n  }\n\n  if (isStand) {\n    return { width: 0.2, depth: 0.2, height: 1.5, color: COLORS.stand, shape: 'pole' };\n  }\n\n  // Instrument / Gear detection\n  if (label.includes('amp')) {\n    return { width: 0.7, depth: 0.4, height: 0.7, color: COLORS.amp, shape: 'box' };\n  }\n  if (label.includes('kit') || label.includes('drum')) {\n    return { width: 1.8, depth: 1.5, height: 0.9, color: COLORS.drum, shape: 'box' };\n  }\n  if (label.includes('keys')) {\n    return { width: 1.2, depth: 0.4, height: 0.9, color: COLORS.keys, shape: 'box' };\n  }\n  if (label.includes('di')) {\n    return { width: 0.2, depth: 0.2, height: 0.1, color: COLORS.di, shape: 'box' };\n  }\n  if (label.includes('pedal') || label.includes('modeller')) {\n    return { width: 0.6, depth: 0.3, height: 0.1, color: COLORS.pedalboard, shape: 'box' };\n  }\n  if (label.includes('mic')) {\n    return { width: 0.2, depth: 0.2, height: 1.5, color: COLORS.mic, shape: 'pole' };\n  }\n  \n  if (label.includes('gtr') || label.includes('guitar') || label.includes('bass') || label.includes('sax') || label.includes('tpt') || label.includes('brass')) {\n     // Instrument on stand\n     return { width: 0.4, depth: 0.3, height: 1.0, color: COLORS.instrument, shape: 'instrument' };\n  }\n\n  // Fallback\n  return { width: 0.3, depth: 0.3, height: 0.3, color: '#cbd5e1', shape: 'box' };\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///Users/rikdewit/code/Miked.app/utils/stageHelpers.ts"],"sourcesContent":["\nimport { BandMember, StageItem, InstrumentType, PersonPose } from '../types';\nimport { STAGE_WIDTH, STAGE_DEPTH } from './stageConfig';\nimport { INSTRUMENTS } from '../constants';\n\n// --- Instrument Equipment Helpers ---\nexport const getAmpCount = (instId: string): number => {\n  // gtr_amp_2 has 2 amps, all others with 'amp' have 1\n  return instId === 'gtr_amp_2' ? 2 : 1;\n};\n\nexport const getDiInputCount = (instId: string): number => {\n  if (instId === 'dj') return 2; // DJ L + DJ R\n  if (instId === 'keys_stereo') return 2; // Keys L + Keys R\n  if (instId === 'tracks_stereo') return 2; // Tracks L + Tracks R\n  if (instId === 'gtr_modeler_stereo') return 2; // Modeller L + Modeller R\n  if (instId === 'bass_combined') return 2; // Bass DI + Bass Amp (though amp is mic)\n  return 1; // Everything else with DI is mono\n};\n\nexport const getDiLabel = (instId: string): string => {\n  const count = getDiInputCount(instId);\n  return count > 1 ? `DI (${count})` : 'DI';\n};\n\nexport const shouldCreateModeller = (instId: string): boolean => {\n  return instId.includes('modeler');\n};\n\n// --- Coordinate Helpers (Data % <-> World) ---\nexport const percentToX = (p: number) => ((p / 100) * STAGE_WIDTH) - (STAGE_WIDTH / 2);\nexport const percentToZ = (p: number) => ((p / 100) * STAGE_DEPTH) - (STAGE_DEPTH / 2);\nexport const xToPercent = (w: number) => ((w + (STAGE_WIDTH / 2)) / STAGE_WIDTH) * 100;\nexport const zToPercent = (w: number) => ((w + (STAGE_DEPTH / 2)) / STAGE_DEPTH) * 100;\n\n// --- Logic to generate individual items for a member ---\nexport const generateMemberItems = (member: BandMember, startX: number, startY: number, idBaseOverride?: string): StageItem[] => {\n    const items: StageItem[] = [];\n    const baseId = idBaseOverride || `${member.id}-${Date.now()}`;\n\n    // 1. The Person (No instrument Index)\n    items.push({ \n        id: `person-${baseId}`, \n        memberId: member.id, \n        type: 'person', \n        label: member.name || 'Musician', \n        x: startX, \n        y: startY,\n        isPeripheral: false \n    });\n\n    // 2. Instruments & Gear\n    let ampCount = 0;\n    let hasAssignedHeld = false; // Flag to ensure only one instrument is \"held\"\n\n    member.instruments.forEach((slot, idx) => {\n        const instId = slot.instrumentId;\n        const inst = INSTRUMENTS.find(i => i.id === instId);\n        if (!inst) return;\n\n        // Offsets to spread items around the person\n        const isRight = idx % 2 === 0;\n        const spreadX = isRight ? 8 : -8; \n        \n        // Note: Drums, Keys (main body), and Vocals are now part of the Person model, \n        // so we do not generate separate stage items for them.\n\n        // KEYS - Only add peripherals like DI\n        if (inst.type === InstrumentType.KEYS) {\n            // Add DI Box for Keys\n            const diInputCount = instId.includes('stereo') ? 2 : 1;\n            const diLabel = diInputCount > 1 ? `DI (${diInputCount})` : 'DI';\n            items.push({\n                id: `di-${baseId}-${idx}`,\n                memberId: member.id,\n                type: 'member',\n                label: diLabel,\n                x: startX + spreadX + (isRight ? 3 : -3),\n                y: startY + 5,\n                fromInstrumentIndex: idx,\n                isPeripheral: true\n            });\n        }\n\n        // AMPS\n        else if (instId.includes('amp') || instId.includes('combined')) {\n           const numAmps = getAmpCount(instId);\n           for (let ampIdx = 0; ampIdx < numAmps; ampIdx++) {\n               const ampX = startX + (ampCount % 2 === 0 ? -12 : 12);\n               items.push({ id: `amp-${baseId}-${idx}-${ampIdx}`, memberId: member.id, type: 'member', label: 'Amp', x: ampX, y: startY - 10, fromInstrumentIndex: idx, isPeripheral: true });\n               ampCount++;\n           }\n        }\n\n        // INSTRUMENTS ON STANDS OR HELD (Guitar/Bass/Brass)\n        if ([InstrumentType.GUITAR, InstrumentType.BASS, InstrumentType.BRASS].includes(inst.type)) {\n            let isHeld = false;\n            \n            // If we haven't assigned a handheld instrument yet, this one becomes held.\n            if (!hasAssignedHeld) {\n                hasAssignedHeld = true;\n                isHeld = true;\n            }\n\n            if (!isHeld) {\n                // Instrument Body on Stand (Core)\n                items.push({ \n                    id: `inst-${baseId}-${idx}`, \n                    memberId: member.id, \n                    type: 'member', \n                    label: inst.group, // Use Group Name (e.g. \"Acoustic Guitar\") instead of Type (\"Guitar\")\n                    x: startX + spreadX, \n                    y: startY - 5,\n                    fromInstrumentIndex: idx,\n                    isPeripheral: false \n                });\n            }\n\n            // Pedalboard / Modeller (Peripheral)\n            if (shouldCreateModeller(instId)) {\n                 items.push({ id: `mod-${baseId}-${idx}`, memberId: member.id, type: 'member', label: 'Modeller', x: startX + spreadX, y: startY + 8, fromInstrumentIndex: idx, isPeripheral: true });\n            } else if (inst.type !== InstrumentType.BRASS && inst.id !== 'gtr_ac') {\n                 items.push({ id: `pedal-${baseId}-${idx}`, memberId: member.id, type: 'member', label: 'Pedals', x: startX + spreadX, y: startY + 8, fromInstrumentIndex: idx, isPeripheral: true });\n            }\n            \n            // DI Box (Peripheral)\n            if (inst.defaultDi || instId.includes('di')) {\n                 const diLabel = getDiLabel(instId);\n                 items.push({ id: `di-${baseId}-${idx}`, memberId: member.id, type: 'member', label: diLabel, x: startX + spreadX + (isRight?2:-2), y: startY + 5, fromInstrumentIndex: idx, isPeripheral: true });\n            }\n        }\n    });\n\n    return items;\n};\n\n// --- Helper to determine Person Pose based on instruments ---\nexport const getPersonPose = (member: BandMember): { pose: PersonPose; heldInstrumentId?: string } => {\n    let pose: PersonPose = 'stand';\n    let heldInstrumentId: string | undefined;\n\n    // 1. Roles (Drums, Keys, DJ, Vocals)\n    const hasDrums = member.instruments.some(slot => INSTRUMENTS.find(i => i.id === slot.instrumentId)?.type === InstrumentType.DRUMS);\n    const hasKeys = member.instruments.some(slot => INSTRUMENTS.find(i => i.id === slot.instrumentId)?.type === InstrumentType.KEYS);\n    const hasDj = member.instruments.some(slot => slot.instrumentId === 'dj');\n    const hasVocal = member.instruments.some(slot => INSTRUMENTS.find(i => i.id === slot.instrumentId)?.type === InstrumentType.VOCAL);\n\n    if (hasDrums) {\n        pose = 'drums';\n    } else if (hasDj) {\n        pose = 'dj';\n    } else if (hasKeys) {\n        pose = 'keys';\n    } else {\n        // 2. Held Instruments (Guitar, Bass, Brass)\n        const heldSlot = member.instruments.find(slot => {\n            const inst = INSTRUMENTS.find(i => i.id === slot.instrumentId);\n            return inst && [InstrumentType.GUITAR, InstrumentType.BASS, InstrumentType.BRASS].includes(inst.type);\n        });\n        heldInstrumentId = heldSlot?.instrumentId;\n\n        if (heldInstrumentId) {\n            const inst = INSTRUMENTS.find(i => i.id === heldInstrumentId);\n            const labelLower = (inst?.group || '').toLowerCase();\n            \n            if (inst?.type === InstrumentType.BASS) pose = 'bass';\n            else if (inst?.id === 'gtr_ac' || labelLower.includes('acoustic')) pose = 'acoustic';\n            else if (inst?.type === InstrumentType.GUITAR) pose = 'guitar';\n            else if (labelLower.includes('trumpet') || labelLower.includes('tpt')) pose = 'trumpet';\n            else if (labelLower.includes('sax')) pose = 'sax';\n        } else if (hasVocal) {\n            pose = 'singing';\n        }\n    }\n\n    return { pose, heldInstrumentId };\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 397, "column": 0}, "map": {"version":3,"sources":["file:///Users/rikdewit/code/Miked.app/components/3d/StageModels.tsx"],"sourcesContent":["\nimport { useMemo } from 'react';\nimport { useGLTF } from '@react-three/drei';\nimport * as THREE from 'three';\n// @ts-ignore\nimport { clone as cloneGLTF } from 'three/examples/jsm/utils/SkeletonUtils';\nimport { PersonPose } from '../../types';\n\nconst BASE_URL = '/assets/';\n\nconst URLS = {\n  GUITAR_ELEC: BASE_URL + 'Electric_Guitar_Telecaster_Blue.glb',\n  GUITAR_ACOUSTIC: BASE_URL + 'Acoustic_Guitar_Beige.glb',\n  BASS: BASE_URL + 'Bass_Guitar_Firebird_Red.glb',\n  AMPLIFIER: BASE_URL + 'Amplifier.glb',\n  DRUMS: BASE_URL + 'Drums_A.glb',\n  PERSON: BASE_URL + 'Male_Strong.glb',\n  \n  // Baked Animation Models\n  MALE_ACOUSTIC: BASE_URL + 'Male_Ac_Guitar_Playing.glb',\n  MALE_BASS: BASE_URL + 'Male_Bass_Playing.glb',\n  MALE_DRUMS: BASE_URL + 'Male_Drumming.glb', \n  MALE_GUITAR: BASE_URL + 'Male_Guitar_Playing.glb',\n  MALE_KEYS: BASE_URL + 'Male_Keys_Playing.glb',\n  MALE_TRUMPET: BASE_URL + 'Male_Trumpet_Playing.glb',\n  MALE_SAX: BASE_URL + 'Male_Sax_Playing.glb',\n  MALE_SINGING: BASE_URL + 'Male_Singing.glb',\n  MALE_DJ: BASE_URL + 'Male_DJ.glb',\n\n  MIC_STAND: BASE_URL + 'Microfon_Stand_B.glb',\n  SAX: BASE_URL + 'Saxophone.glb',\n  TRUMPET: BASE_URL + 'Trumpet.glb',\n  STAND: BASE_URL + 'Stand.glb',\n  SYNTH: BASE_URL + 'Synth.glb',\n};\n\n// Preload models\nObject.values(URLS).forEach(url => useGLTF.preload(url));\n\n// --- CENTRALIZED OFFSETS ---\nexport const MODEL_OFFSETS = {\n  DRUMS: [0, 0, 0] as [number, number, number],\n  SAX: [0, 0, 0] as [number, number, number],\n  TRUMPET: [0, 0, 0] as [number, number, number],\n  SYNTH: [0, 0, 0] as [number, number, number],\n  DEFAULT: [0, 0, 0] as [number, number, number],\n};\n\nexport const useStageModel = (url: string, color?: string) => {\n  const { scene } = useGLTF(url);\n  \n  const model = useMemo(() => {\n      const cloned = cloneGLTF(scene);\n      cloned.traverse((node: any) => {\n          if (node.isMesh) {\n             const mesh = node as THREE.Mesh;\n             mesh.castShadow = true;\n             mesh.receiveShadow = true;\n             \n             if (color && mesh.material) {\n                 const materials = Array.isArray(mesh.material) ? mesh.material : [mesh.material];\n                 const newMaterials = materials.map(m => {\n                     const nm = m.clone() as THREE.MeshStandardMaterial;\n                     nm.color.set(color);\n                     nm.metalness = 0.1;\n                     nm.roughness = 0.6;\n                     return nm;\n                 });\n                 mesh.material = Array.isArray(mesh.material) ? newMaterials : newMaterials[0];\n             }\n          }\n      });\n      return cloned;\n  }, [scene, color]);\n\n  return model;\n};\n\n// --- Simplified Instrument Models ---\n\nexport const ElectricGuitarModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.GUITAR_ELEC, color);\n  return <primitive object={model} scale={1} rotation={[0, Math.PI / 2, 0]} position={MODEL_OFFSETS.DEFAULT} />;\n};\n\nexport const AcousticGuitarModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.GUITAR_ACOUSTIC, color);\n  return <primitive object={model} scale={1} rotation={[0, Math.PI / 2, 0]} position={MODEL_OFFSETS.DEFAULT} />;\n};\n\nexport const BassModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.BASS, color);\n  return <primitive object={model} scale={1} rotation={[0, 0, 0]} position={MODEL_OFFSETS.DEFAULT} />;\n};\n\nexport const AmpModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.AMPLIFIER, color);\n  return <primitive object={model} scale={1} position={MODEL_OFFSETS.DEFAULT} />;\n};\n\nexport const DrumsModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.DRUMS, color);\n  return <primitive object={model} scale={1} position={MODEL_OFFSETS.DRUMS} rotation={[0, 0, 0]} />;\n};\n\nexport const SynthModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.SYNTH, color);\n  return <primitive object={model} scale={1} position={MODEL_OFFSETS.SYNTH} rotation={[0, Math.PI, 0]} />;\n};\n\nexport const MicStandModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.MIC_STAND, color);\n  return <primitive object={model} scale={1} position={MODEL_OFFSETS.DEFAULT} rotation={[0, Math.PI, 0]} />;\n};\n\nexport const SaxModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.SAX, color);\n  return <primitive object={model} scale={1} position={MODEL_OFFSETS.SAX} />;\n};\n\nexport const TrumpetModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.TRUMPET, color);\n  return <primitive object={model} scale={1} position={MODEL_OFFSETS.TRUMPET} />;\n};\n\nexport const StandModel = ({ color }: { color?: string }) => {\n  const model = useStageModel(URLS.STAND, color);\n  return <primitive object={model} scale={1} position={MODEL_OFFSETS.DEFAULT} />;\n};\n\nexport const PersonModel = ({ color, pose = 'stand' }: { color?: string, pose?: PersonPose }) => {\n  // Load the appropriate baked animation model based on pose\n  let url = URLS.PERSON;\n  if (pose === 'acoustic') url = URLS.MALE_ACOUSTIC;\n  else if (pose === 'bass') url = URLS.MALE_BASS;\n  else if (pose === 'guitar') url = URLS.MALE_GUITAR;\n  else if (pose === 'drums') url = URLS.MALE_DRUMS;\n  else if (pose === 'keys') url = URLS.MALE_KEYS;\n  else if (pose === 'trumpet') url = URLS.MALE_TRUMPET;\n  else if (pose === 'sax') url = URLS.MALE_SAX;\n  else if (pose === 'singing') url = URLS.MALE_SINGING;\n  else if (pose === 'dj') url = URLS.MALE_DJ;\n\n  const { scene } = useGLTF(url);\n\n  const personModel = useMemo(() => {\n    const cloned = cloneGLTF(scene);\n\n    cloned.traverse((node: any) => {\n      if (node.isMesh) {\n        const mesh = node as THREE.Mesh;\n        mesh.castShadow = true;\n        mesh.receiveShadow = true;\n        if (color && mesh.material) {\n          const materials = Array.isArray(mesh.material) ? mesh.material : [mesh.material];\n          const newMaterials = materials.map(m => {\n            const nm = m.clone() as THREE.MeshStandardMaterial;\n            nm.color.set(color);\n            nm.metalness = 0.1;\n            nm.roughness = 0.6;\n            return nm;\n          });\n          mesh.material = Array.isArray(mesh.material) ? newMaterials : newMaterials[0];\n        }\n      }\n    });\n\n    return cloned;\n  }, [scene, color]);\n\n  return (\n    <group>\n      <primitive object={personModel} scale={1} position={MODEL_OFFSETS.DEFAULT} />\n    </group>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 839, "column": 0}, "map": {"version":3,"sources":["file:///Users/rikdewit/code/Miked.app/components/3d/StageDraggableItem.tsx"],"sourcesContent":["\nimport React, { Suspense, useRef, useState, useEffect } from 'react';\nimport { ThreeEvent, useThree } from '@react-three/fiber';\nimport { Html } from '@react-three/drei';\nimport * as THREE from 'three';\nimport { ChevronLeft, ChevronRight, Trash2 } from 'lucide-react';\nimport { StageItem, BandMember, PersonPose } from '../../types';\nimport { getItemConfig } from '../../utils/stageConfig';\nimport { percentToX, percentToZ, getPersonPose } from '../../utils/stageHelpers';\nimport { MODEL_LABEL_FONT_SCALE_INTERACTIVE, MODEL_LABEL_FONT_SCALE_PREVIEW } from '../../constants';\nimport * as Models from './StageModels';\nimport { MODEL_OFFSETS } from './StageModels';\n\ninterface DraggableItemProps {\n  item: StageItem;\n  activeId: string | null;\n  onDown: (e: ThreeEvent<PointerEvent>, id: string) => void;\n  onMove: (e: ThreeEvent<PointerEvent>) => void;\n  onUp: (e: ThreeEvent<PointerEvent>) => void;\n  isGhost?: boolean;\n  member?: BandMember;\n  isRotating?: boolean;\n  showRotationUI?: boolean;\n  onRequestRotationUI?: () => void;\n  onCloseRotationUI?: () => void;\n  onRotate?: (itemId: string, direction: 'left' | 'right') => void;\n  onDelete?: (itemId: string) => void;\n  onQuantityChange?: (itemId: string, quantity: number) => void;\n  onMonitorNumberChange?: (itemId: string, monitorNumber: number) => void;\n  onLabelChange?: (itemId: string, label: string) => void;\n  onHeightChange?: (itemId: string, height: number) => void;\n  onLabelHeightChange?: (itemId: string, height: number) => void;\n  onResizeStart?: (itemId: string) => void;\n  isEditable?: boolean;\n  viewMode?: 'isometric' | 'top';\n  isPreview?: boolean;\n}\n\nexport const StageDraggableItem: React.FC<DraggableItemProps> = ({\n  item,\n  activeId,\n  onDown,\n  onMove,\n  onUp,\n  isGhost = false,\n  member,\n  isRotating = false,\n  showRotationUI = false,\n  onRequestRotationUI,\n  onCloseRotationUI,\n  onRotate,\n  onDelete,\n  onQuantityChange,\n  onMonitorNumberChange,\n  onLabelChange,\n  onHeightChange,\n  onLabelHeightChange,\n  onResizeStart,\n  isEditable = false,\n  viewMode = 'isometric',\n  isPreview = false\n}) => {\n  const { width, height, depth, color, shape } = getItemConfig(item);\n  const x = percentToX(item.x);\n  const z = percentToZ(item.y);\n  const isDragging = activeId === item.id;\n  const activeColor = '#fbbf24';\n  \n  const opacity = isGhost ? 0.6 : 1;\n  const transparent = isGhost;\n  const materialProps = { opacity, transparent, roughness: 0.4 };\n\n  // Track pointer position to detect clicks vs drags\n  const downPosRef = useRef<{ x: number; y: number } | null>(null);\n  const threshold = 1; // pixels - if movement > this, it's a drag\n\n  // Get THREE.js camera for bounding box calculations\n  const { camera } = useThree();\n\n  // Calculate object's screen-space bounding box\n  const getObjectScreenBounds = () => {\n    const corners = [\n      new THREE.Vector3(x - width / 2, 0, z - depth / 2),\n      new THREE.Vector3(x + width / 2, 0, z - depth / 2),\n      new THREE.Vector3(x - width / 2, height, z - depth / 2),\n      new THREE.Vector3(x + width / 2, height, z - depth / 2),\n      new THREE.Vector3(x - width / 2, 0, z + depth / 2),\n      new THREE.Vector3(x + width / 2, 0, z + depth / 2),\n      new THREE.Vector3(x - width / 2, height, z + depth / 2),\n      new THREE.Vector3(x + width / 2, height, z + depth / 2),\n    ];\n\n    const screenCorners = corners.map(corner => {\n      corner.project(camera);\n      return {\n        x: (corner.x + 1) / 2 * window.innerWidth,\n        y: (1 - corner.y) / 2 * window.innerHeight,\n      };\n    });\n\n    return {\n      minX: Math.min(...screenCorners.map(c => c.x)),\n      maxX: Math.max(...screenCorners.map(c => c.x)),\n      minY: Math.min(...screenCorners.map(c => c.y)),\n      maxY: Math.max(...screenCorners.map(c => c.y)),\n    };\n  };\n\n  // Context menu positioning\n  const contextMenuRef = useRef<HTMLDivElement>(null);\n  const [contextMenuOffset, setContextMenuOffset] = useState<{ y: number; z: number }>({ y: 0, z: 0 });\n  const fixedContextMenuPosRef = useRef<{ y: number; z: number } | null>(null);\n  const prevShowRotationUIRef = useRef(false);\n  const [menuReady, setMenuReady] = useState(false);\n\n  const showLabel = true;\n  const labelLower = (item.label || '').toLowerCase();\n\n  // Calculate scaled font size for preview vs interactive\n  const baseFontSize = 10;\n  const fontScale = isPreview ? MODEL_LABEL_FONT_SCALE_PREVIEW : MODEL_LABEL_FONT_SCALE_INTERACTIVE;\n  const scaledFontSize = baseFontSize * fontScale;\n\n  // --- Offset Logic for Visual Alignment ---\n  let offset = MODEL_OFFSETS.DEFAULT;\n  if (shape !== 'person') {\n    if (labelLower.includes('drum') || labelLower.includes('kit')) {\n        offset = MODEL_OFFSETS.DRUMS;\n    } else if (labelLower.includes('sax')) {\n        offset = MODEL_OFFSETS.SAX;\n    } else if (labelLower.includes('trumpet') || labelLower.includes('tpt')) {\n        offset = MODEL_OFFSETS.TRUMPET;\n    }\n  }\n\n  const [offX, offY, offZ] = offset;\n\n  let labelYPadding = 0.3;\n  if (shape === 'person') {\n      labelYPadding = 0.65;\n  } else if (labelLower.includes('sax')) {\n      labelYPadding = 0.05;\n  }\n\n  // Isometric: Y = -1.0 puts the menu below the stage floor, which projects below ALL objects on screen.\n  // Top view: Z = depth/2 + 1.2 places the menu below the object's footprint on screen.\n  const calculatedContextMenuPosY = viewMode === 'isometric' ? -1.0 : 0;\n  const calculatedContextMenuPosZ = viewMode === 'top' ? (offZ + depth / 2 + 1.2) : offZ;\n\n  // When menu opens: render it invisible at the initial position, measure actual bounds, correct,\n  // then reveal. This prevents any visible jump regardless of menu height.\n  useEffect(() => {\n    let timer: ReturnType<typeof setTimeout> | null = null;\n\n    if (showRotationUI && !prevShowRotationUIRef.current) {\n      setMenuReady(false);\n      setContextMenuOffset({ y: 0, z: 0 });\n\n      // Set initial world-space position (menu is invisible at this point)\n      if (viewMode === 'top') {\n        fixedContextMenuPosRef.current = { y: 0, z: offZ + depth / 2 + 1.2 };\n      } else {\n        fixedContextMenuPosRef.current = { y: -1.0, z: offZ };\n      }\n\n      // After DOM renders (one frame is enough), measure actual position and correct if needed\n      timer = setTimeout(() => {\n        const newOffset = { y: 0, z: 0 };\n\n        if (contextMenuRef.current) {\n          const menuRect = contextMenuRef.current.getBoundingClientRect();\n          const objectBounds = getObjectScreenBounds();\n          const margin = 24;\n          const padding = 12;\n\n          const overlapsObject =\n            menuRect.left   < objectBounds.maxX + margin &&\n            menuRect.right  > objectBounds.minX - margin &&\n            menuRect.top    < objectBounds.maxY + margin &&\n            menuRect.bottom > objectBounds.minY - margin;\n\n          const outBottom = menuRect.bottom > window.innerHeight - padding;\n          const outTop    = menuRect.top    < padding;\n          const outLeft   = menuRect.left   < padding;\n          const outRight  = menuRect.right  > window.innerWidth  - padding;\n\n          if (overlapsObject || outBottom || outTop || outLeft || outRight) {\n            const wp0 = new THREE.Vector3(x, 0, z).project(camera);\n            const wpY = new THREE.Vector3(x, 1, z).project(camera);\n            const screenPerWorldY = Math.abs((wpY.y - wp0.y) * (window.innerHeight / 2)) || 80;\n\n            const menuMidY   = (menuRect.top + menuRect.bottom) / 2;\n            const spaceAbove = objectBounds.minY - padding;\n            const spaceBelow = window.innerHeight - objectBounds.maxY - padding;\n\n            if (overlapsObject || outBottom) {\n              if (spaceAbove >= menuRect.height + margin) {\n                const targetMidY = objectBounds.minY - margin - menuRect.height / 2;\n                newOffset.y = -(targetMidY - menuMidY) / screenPerWorldY;\n              } else if (spaceBelow >= menuRect.height + margin) {\n                const targetMidY = objectBounds.maxY + margin + menuRect.height / 2;\n                newOffset.y = -(targetMidY - menuMidY) / screenPerWorldY;\n              } else {\n                const spaceRight = window.innerWidth - objectBounds.maxX - padding;\n                newOffset.z = spaceRight >= menuRect.width + margin ? -2.5 : 2.5;\n              }\n            } else if (outTop) {\n              const targetMidY = padding + menuRect.height / 2;\n              newOffset.y = -(targetMidY - menuMidY) / screenPerWorldY;\n            }\n\n            if (outLeft)       newOffset.z =  2.0;\n            else if (outRight) newOffset.z = -2.0;\n          }\n        }\n\n        setContextMenuOffset(newOffset);\n        setMenuReady(true);\n      // getObjectScreenBounds, x, z, camera etc. are captured by closure at open time\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      }, 50);\n    }\n\n    if (!showRotationUI && prevShowRotationUIRef.current) {\n      fixedContextMenuPosRef.current = null;\n      setMenuReady(false);\n    }\n\n    prevShowRotationUIRef.current = showRotationUI;\n\n    return () => { if (timer) clearTimeout(timer); };\n  // offZ, depth, viewMode, x, z, camera captured by closure at open time\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showRotationUI]);\n\n  // Use fixed position while menu is open, otherwise calculate current position\n  const contextMenuPosY = fixedContextMenuPosRef.current?.y ?? calculatedContextMenuPosY;\n  const contextMenuPosZ = fixedContextMenuPosRef.current?.z ?? calculatedContextMenuPosZ;\n\n  // Hitbox dimensions - match actual model dimensions for better selection\n  // In both views, we need width x depth coverage with small padding\n  const hitboxPadding = 0.2;\n  const hitboxWidth = Math.max(width, 0.6) + hitboxPadding;\n  const hitboxDepth = Math.max(depth, 0.6) + hitboxPadding;\n\n  const renderModel = () => {\n    // --- PERSON ---\n    if (shape === 'person') {\n        const { pose } = member ? getPersonPose(member) : { pose: 'stand' as PersonPose };\n        return <Models.PersonModel color={isDragging ? activeColor : undefined} pose={pose} />;\n    }\n\n    // --- MIC STAND ---\n    if (item.type === 'stand') {\n        return <Models.MicStandModel />;\n    }\n\n    const modelColor = isDragging ? activeColor : color;\n\n    // --- INSTRUMENTS & GEAR ---\n    if (labelLower.includes('amp')) {\n        return <Models.AmpModel color={modelColor} />;\n    }\n    \n    if (labelLower.includes('bass')) {\n         return <Models.BassModel color={modelColor} />;\n    }\n    \n    if (labelLower.includes('acoustic')) {\n         return <Models.AcousticGuitarModel color={modelColor} />;\n    }\n    \n    if (labelLower.includes('guitar')) { \n         return <Models.ElectricGuitarModel color={modelColor} />;\n    }\n\n    if (labelLower.includes('sax')) {\n         return <Models.SaxModel color={modelColor} />;\n    }\n\n    if (labelLower.includes('trumpet') || labelLower.includes('tpt')) {\n         return <Models.TrumpetModel color={modelColor} />;\n    }\n    \n    // --- CUSTOM LABEL-ONLY (invisible hitbox) ---\n    if (item.type === 'custom' && !(item.customWidth ?? 0) && !(item.customDepth ?? 0)) {\n      return (\n        <mesh position={[0, 0.005, 0]}>\n          <boxGeometry args={[0.3, 0.01, 0.3]} />\n          <meshBasicMaterial transparent opacity={0} />\n        </mesh>\n      );\n    }\n\n    // --- FALLBACK BOX/SHAPES ---\n    if (shape === 'wedge') {\n        return (\n             <mesh position={[0, height/2, 0]} rotation={[Math.PI/6, 0, 0]} castShadow={!isGhost} receiveShadow>\n                 <boxGeometry args={[width, height, depth]} />\n                 <meshStandardMaterial color={modelColor} {...materialProps} />\n             </mesh>\n        );\n    }\n    \n    return (\n         <mesh position={[0, height/2, 0]} castShadow={!isGhost} receiveShadow>\n            <boxGeometry args={[width, height, depth]} />\n            <meshStandardMaterial color={modelColor} {...materialProps} />\n         </mesh>\n    );\n  };\n\n  return (\n    <group position={[x, 0, z]}>\n      {showLabel && (\n        <Html\n            position={[0 + offX, item.type === 'custom' && item.labelHeight ? item.labelHeight : height + labelYPadding + offY, 0 + offZ]}\n            center\n            zIndexRange={isDragging ? [500, 400] : [100, 0]}\n            style={{ pointerEvents: isPreview ? 'none' : 'none' }}\n        >\n          <div\n            className={`font-black whitespace-nowrap select-none tracking-tight px-1 rounded border text-center inline-block ${isGhost ? 'text-slate-700 bg-white/30 border-white/10' : 'text-slate-900 bg-white/50 border-white/20'}`}\n            style={{\n              fontSize: `${scaledFontSize}px`,\n              lineHeight: '1.2',\n              padding: '2px 4px',\n              minHeight: '16px',\n              display: 'inline-block',\n              verticalAlign: 'baseline'\n            }}\n          >\n            {item.type === 'power' && item.quantity ? `${item.label} (${item.quantity})` : item.type === 'monitor' && item.monitorNumber ? `${item.label} ${item.monitorNumber}` : item.label}\n          </div>\n        </Html>\n      )}\n\n      {/* Rotation UI - not inside rotating group so it stays fixed */}\n      {showRotationUI && !isGhost && isEditable && (onRotate || item.type === 'power' || item.type === 'monitor' || item.type === 'custom') && (\n        <Html\n            position={[0 + offX, contextMenuPosY + contextMenuOffset.y, contextMenuPosZ + contextMenuOffset.z]}\n            center\n            zIndexRange={[1000, 900]}\n            style={{ pointerEvents: 'auto' }}\n        >\n          <div\n            ref={contextMenuRef}\n            className=\"flex gap-1 bg-slate-900 border border-slate-600 rounded-lg p-1.5 shadow-lg\"\n            style={{ opacity: menuReady ? 1 : 0, pointerEvents: menuReady ? undefined : 'none' }}\n            onClick={(e) => e.stopPropagation()}\n            onPointerDown={(e) => e.stopPropagation()}\n            onPointerUp={(e) => e.stopPropagation()}\n          >\n            {item.type === 'power' ? (\n              <>\n                <button\n                  onClick={() => {\n                    const newQty = Math.max(1, (item.quantity || 1) - 1);\n                    onQuantityChange?.(item.id, newQty);\n                  }}\n                  className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                  title=\"Decrease quantity\"\n                >\n                  −\n                </button>\n                <div className=\"px-2 py-1 text-white text-xs font-bold flex items-center bg-slate-800 rounded\">\n                  {item.quantity || 1}\n                </div>\n                <button\n                  onClick={() => {\n                    onQuantityChange?.(item.id, (item.quantity || 1) + 1);\n                  }}\n                  className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                  title=\"Increase quantity\"\n                >\n                  +\n                </button>\n              </>\n            ) : item.type === 'monitor' ? (\n              <div className=\"flex flex-col gap-1\">\n                <div className=\"flex gap-1\">\n                  <button\n                    onClick={() => {\n                      const newNum = Math.max(0, (item.monitorNumber || 0) - 1);\n                      onMonitorNumberChange?.(item.id, newNum);\n                    }}\n                    className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                    title=\"Decrease monitor number\"\n                  >\n                    −\n                  </button>\n                  <div className=\"px-2 py-1 text-white text-xs font-bold flex items-center bg-slate-800 rounded min-w-[32px] justify-center\">\n                    {item.monitorNumber || 0}\n                  </div>\n                  <button\n                    onClick={() => {\n                      onMonitorNumberChange?.(item.id, (item.monitorNumber || 0) + 1);\n                    }}\n                    className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                    title=\"Increase monitor number\"\n                  >\n                    +\n                  </button>\n                </div>\n                <div className=\"flex gap-1\">\n                  <button\n                    onClick={() => onRotate?.(item.id, 'left')}\n                    className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors flex-1\"\n                    title=\"Rotate left 22.5°\"\n                  >\n                    <ChevronLeft size={14} />\n                  </button>\n                  <button\n                    onClick={() => {\n                      onCloseRotationUI?.();\n                    }}\n                    className=\"px-2 py-1 bg-slate-700 hover:bg-slate-600 text-white rounded text-xs font-medium transition-colors flex-1\"\n                    title=\"Done rotating\"\n                  >\n                    Done\n                  </button>\n                  <button\n                    onClick={() => onRotate?.(item.id, 'right')}\n                    className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors flex-1\"\n                    title=\"Rotate right 22.5°\"\n                  >\n                    <ChevronRight size={14} />\n                  </button>\n                </div>\n              </div>\n            ) : item.type === 'custom' ? (\n              <div className=\"flex flex-col gap-1\">\n                <input\n                  type=\"text\"\n                  value={item.label}\n                  onChange={(e) => onLabelChange?.(item.id, e.target.value)}\n                  className=\"px-2 py-1 bg-slate-800 border border-slate-600 rounded text-white text-xs focus:outline-none focus:border-indigo-500 w-full min-w-[120px]\"\n                  placeholder=\"Name...\"\n                  autoFocus\n                  onKeyDown={(e) => { if (e.key === 'Enter') onCloseRotationUI?.(); }}\n                />\n                {(item.customWidth ?? 0) === 0 && (item.customDepth ?? 0) === 0 && (\n                  <div className=\"flex items-center gap-1\">\n                    <span className=\"text-slate-400 text-[10px] w-7\">Label</span>\n                    <button\n                      onClick={() => onLabelHeightChange?.(item.id, (item.labelHeight ?? 1.7) - 0.2)}\n                      className=\"p-1 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors text-[10px]\"\n                    >−</button>\n                    <div className=\"px-1 py-1 text-white text-[10px] font-bold flex items-center bg-slate-800 rounded min-w-[32px] justify-center\">\n                      {((item.labelHeight ?? 1.7)).toFixed(1)}m\n                    </div>\n                    <button\n                      onClick={() => onLabelHeightChange?.(item.id, (item.labelHeight ?? 1.7) + 0.2)}\n                      className=\"p-1 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors text-[10px]\"\n                    >+</button>\n                  </div>\n                )}\n                {(item.customWidth ?? 0) > 0 && (\n                  <>\n                    <div className=\"flex items-center gap-1\">\n                      <span className=\"text-slate-400 text-[10px] w-8\">W</span>\n                      <button onClick={() => onResizeStart?.(item.id)} className=\"flex-1 px-2 py-1 bg-slate-700 hover:bg-slate-600 text-white rounded text-xs font-medium transition-colors flex items-center justify-center gap-1\" title=\"Move cursor to resize width/depth. Switch to Top View for best results. Click canvas to finish.\">⇲ Drag</button>\n                    </div>\n                    <div className=\"flex items-center gap-1\">\n                      <span className=\"text-slate-400 text-[10px] w-8\">H</span>\n                      <button\n                        onClick={() => onHeightChange?.(item.id, (item.customHeight ?? 0.3) - 0.2)}\n                        className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                      >−</button>\n                      <div className=\"px-1 py-1 text-white text-[10px] font-bold flex items-center bg-slate-800 rounded min-w-[32px] justify-center\">\n                        {((item.customHeight ?? 0.3) * 10).toFixed(0) === '0' ? '0.1' : ((item.customHeight ?? 0.3)).toFixed(1)}m\n                      </div>\n                      <button\n                        onClick={() => onHeightChange?.(item.id, (item.customHeight ?? 0.3) + 0.2)}\n                        className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                      >+</button>\n                    </div>\n                  </>\n                )}\n                <div className=\"flex gap-1\">\n                  <button\n                    onClick={() => onRotate?.(item.id, 'left')}\n                    className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors flex-1\"\n                    title=\"Rotate left 22.5°\"\n                  >\n                    <ChevronLeft size={14} />\n                  </button>\n                  <button\n                    onClick={() => onCloseRotationUI?.()}\n                    className=\"px-2 py-1 bg-slate-700 hover:bg-slate-600 text-white rounded text-xs font-medium transition-colors flex-1\"\n                    title=\"Done\"\n                  >\n                    Done\n                  </button>\n                  <button\n                    onClick={() => onRotate?.(item.id, 'right')}\n                    className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors flex-1\"\n                    title=\"Rotate right 22.5°\"\n                  >\n                    <ChevronRight size={14} />\n                  </button>\n                </div>\n              </div>\n            ) : (\n              <>\n                <button\n                  onClick={() => onRotate?.(item.id, 'left')}\n                  className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                  title=\"Rotate left 22.5°\"\n                >\n                  <ChevronLeft size={14} />\n                </button>\n                <button\n                  onClick={() => {\n                    onCloseRotationUI?.();\n                  }}\n                  className=\"px-2 py-1 bg-slate-700 hover:bg-slate-600 text-white rounded text-xs font-medium transition-colors\"\n                  title=\"Done rotating\"\n                >\n                  Done\n                </button>\n                <button\n                  onClick={() => onRotate?.(item.id, 'right')}\n                  className=\"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors\"\n                  title=\"Rotate right 22.5°\"\n                >\n                  <ChevronRight size={14} />\n                </button>\n              </>\n            )}\n            <div className=\"w-px bg-slate-600\" />\n            <button\n              onClick={() => onDelete?.(item.id)}\n              className=\"p-1.5 bg-red-700 hover:bg-red-600 text-white rounded transition-colors\"\n              title=\"Delete\"\n            >\n              <Trash2 size={14} />\n            </button>\n          </div>\n        </Html>\n      )}\n\n      <group\n        rotation={[0, item.rotation || 0, 0]}\n        onPointerDown={!isGhost ? (e) => {\n          e.stopPropagation();\n          // Track pointer position for click detection\n          downPosRef.current = { x: e.clientX, y: e.clientY };\n          \n          if (showRotationUI) {\n            // Click while rotation UI showing - close it\n            onCloseRotationUI?.();\n          } else {\n            // First click or switching items - initiate drag/selection\n            onDown(e, item.id);\n          }\n        } : undefined}\n        onPointerMove={!isGhost && !showRotationUI ? onMove : undefined}\n        onPointerUp={!isGhost ? (e) => {\n          e.stopPropagation();\n          \n          // Check if this was a click (no significant drag) or actual drag\n          const wasDrag = downPosRef.current && (\n            Math.abs(e.clientX - downPosRef.current.x) > threshold ||\n            Math.abs(e.clientY - downPosRef.current.y) > threshold\n          );\n          downPosRef.current = null;\n          \n          if (!showRotationUI) {\n            // Normal up handler for dragging\n            onUp(e);\n          }\n          \n          // Show rotation UI in response to a click (not a drag) on already-selected item\n          if (!wasDrag && isEditable && activeId === item.id && !showRotationUI) {\n            onRequestRotationUI?.();\n          }\n        } : undefined}\n      >\n        {/* Invisible Hit Box for easier selection */}\n        {/* For custom labels, position hitbox at label height; otherwise use item height */}\n        {(() => {\n          const isLabelOnly = item.type === 'custom' && (item.customWidth ?? 0) === 0 && (item.customDepth ?? 0) === 0;\n          const hitboxY = isLabelOnly && item.labelHeight ? item.labelHeight : height / 2 + offY;\n          return (\n            <mesh position={[0 + offX, hitboxY, 0 + offZ]}>\n              <boxGeometry args={[hitboxWidth, isLabelOnly ? 0.4 : height, hitboxDepth]} />\n              <meshBasicMaterial transparent opacity={0} />\n            </mesh>\n          );\n        })()}\n\n        <Suspense fallback={\n            <mesh position={[0, height/2, 0]}>\n                <boxGeometry args={[width, height, depth]} />\n                <meshStandardMaterial color={color} opacity={0.5} transparent />\n            </mesh>\n        }>\n            {renderModel()}\n        </Suspense>\n      </group>\n    </group>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1866, "column": 0}, "map": {"version":3,"sources":["file:///Users/rikdewit/code/Miked.app/components/StagePlotCanvas.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, Suspense } from 'react';\nimport { StageItem, BandMember } from '../types';\nimport { Canvas, ThreeEvent, useThree } from '@react-three/fiber';\nimport { OrthographicCamera, Grid, ContactShadows, Text } from '@react-three/drei';\nimport * as THREE from 'three';\nimport { STAGE_WIDTH, STAGE_DEPTH, getItemConfig } from '../utils/stageConfig';\nimport { percentToX, percentToZ, xToPercent, zToPercent } from '../utils/stageHelpers';\nimport { StageDraggableItem } from './3d/StageDraggableItem';\nimport { MODEL_OFFSETS } from './3d/StageModels';\nimport { CAMERA_TOP_INTERACTIVE, CAMERA_TOP_PREVIEW, CAMERA_ISO_INTERACTIVE, CAMERA_ISO_PREVIEW, AUDIENCE_TEXT_FONT_SCALE_INTERACTIVE, AUDIENCE_TEXT_FONT_SCALE_PREVIEW } from '../constants';\n\n// Component that captures canvas screenshot for preview mode\n// Camera position/zoom is already set by ResponsiveCameraAdjuster — just capture what's rendered\nconst ScreenshotCapture = ({ isPreview, containerRef, onScreenshot }: { isPreview: boolean; containerRef: React.RefObject<HTMLDivElement>; onScreenshot: (dataUrl: string) => void }) => {\n  useEffect(() => {\n    if (!isPreview) return;\n\n    // Wait for ResponsiveCameraAdjuster to apply zoom-to-fit and for Three.js to render\n    const timer = setTimeout(() => {\n      if (containerRef.current) {\n        // Add CSS fix before capturing\n        const style = document.createElement('style');\n        style.textContent = `\n          img { display: inline-block !important; }\n          div { line-height: 1 !important; }\n          * { line-height: 1 !important; }\n        `;\n        document.head.appendChild(style);\n\n        import('html2canvas').then((html2canvas) => {\n          html2canvas.default(containerRef.current!, {\n            backgroundColor: '#f1f5f9',\n            scale: 2,\n            logging: false,\n            useCORS: true,\n            imageTimeout: 5000,\n            allowTaint: true,\n          }).then((canvas) => {\n            onScreenshot(canvas.toDataURL('image/png'));\n            // Clean up the style\n            document.head.removeChild(style);\n          });\n        });\n      }\n    }, 200);\n\n    return () => clearTimeout(timer);\n  }, [isPreview, containerRef, onScreenshot]);\n\n  return null;\n};\n\n// Component to handle responsive camera zoom and orientation\nconst ResponsiveCameraAdjuster = ({ isTopView, isPreview }: { isTopView: boolean; isPreview: boolean }) => {\n  const { camera, size } = useThree();\n\n  useEffect(() => {\n    if (!camera) return;\n\n    const orthoCamera = camera as THREE.OrthographicCamera;\n\n    // Pick the right settings from constants\n    const cfg = isTopView\n      ? (isPreview ? CAMERA_TOP_PREVIEW : CAMERA_TOP_INTERACTIVE)\n      : (isPreview ? CAMERA_ISO_PREVIEW : CAMERA_ISO_INTERACTIVE);\n\n    // Set camera up vector FIRST (before lookAt)\n    camera.up.set(...(isTopView ? [0, 0, -1] : [0, 1, 0]) as [number, number, number]);\n\n    camera.position.set(...cfg.position);\n    camera.lookAt(...cfg.lookAt);\n\n    camera.updateMatrix();\n    camera.updateMatrixWorld();\n\n    // Zoom-to-fit: project stage bounding box corners at zoom=1, then scale to fill viewport.\n    // This works for any camera angle or canvas size without hardcoded magic numbers.\n    orthoCamera.zoom = 1;\n    camera.updateProjectionMatrix();\n\n    const h = cfg.modelHeight;\n    const corners = [\n      new THREE.Vector3(-STAGE_WIDTH / 2, 0, -STAGE_DEPTH / 2),\n      new THREE.Vector3( STAGE_WIDTH / 2, 0, -STAGE_DEPTH / 2),\n      new THREE.Vector3(-STAGE_WIDTH / 2, 0,  STAGE_DEPTH / 2),\n      new THREE.Vector3( STAGE_WIDTH / 2, 0,  STAGE_DEPTH / 2),\n      new THREE.Vector3(-STAGE_WIDTH / 2, h, -STAGE_DEPTH / 2),\n      new THREE.Vector3( STAGE_WIDTH / 2, h, -STAGE_DEPTH / 2),\n      new THREE.Vector3(-STAGE_WIDTH / 2, h,  STAGE_DEPTH / 2),\n      new THREE.Vector3( STAGE_WIDTH / 2, h,  STAGE_DEPTH / 2),\n    ];\n\n    let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;\n    for (const corner of corners) {\n      const ndc = corner.clone().project(camera);\n      if (ndc.x < minX) minX = ndc.x;\n      if (ndc.x > maxX) maxX = ndc.x;\n      if (ndc.y < minY) minY = ndc.y;\n      if (ndc.y > maxY) maxY = ndc.y;\n    }\n\n    // NDC range [-1,1] covers the full viewport. Zoom needed to fit the projected extent:\n    const zoomX = 2 / ((maxX - minX) * (1 + cfg.padding));\n    const zoomY = 2 / ((maxY - minY) * (1 + cfg.padding));\n    orthoCamera.zoom = Math.min(zoomX, zoomY);\n    camera.updateProjectionMatrix();\n  }, [size, camera, isTopView, isPreview]);\n\n  return null;\n};\n\ninterface StagePlotCanvasProps {\n  items: StageItem[];\n  setItems: (items: StageItem[]) => void;\n  editable: boolean;\n  viewMode?: 'isometric' | 'top';\n  showAudienceLabel?: boolean;\n  isPreview?: boolean;\n  ghostItems?: StageItem[];\n  dragCoords?: { x: number; y: number; width: number; height: number } | null;\n  onDragPosChange?: (x: number, y: number) => void;\n  members?: BandMember[];\n  rotatingItemId?: string | null;\n  onRotateItem?: (itemId: string, direction: 'left' | 'right') => void;\n  onScreenshot?: (dataUrl: string) => void;\n}\n\nconst StagePlatform = () => {\n  const thickness = 0.2;\n  return (\n    <group position={[0, -thickness / 2, 0]}>\n      <mesh receiveShadow position={[0, 0, 0]}>\n        <boxGeometry args={[STAGE_WIDTH, thickness, STAGE_DEPTH]} />\n        <meshStandardMaterial color=\"#e2e8f0\" roughness={0.6} />\n      </mesh>\n    </group>\n  );\n};\n\n// Component to handle External Drag Logic inside Canvas context\nconst ExternalDragHandler = ({ \n  dragCoords, \n  onUpdate \n}: { \n  dragCoords: { x: number; y: number; width: number; height: number };\n  onUpdate: (x: number, y: number) => void;\n}) => {\n  const { camera, raycaster } = useThree();\n  const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\n  const mouse = new THREE.Vector2();\n  const intersectPoint = new THREE.Vector3();\n\n  useEffect(() => {\n    // Convert Pixel Coords to NDC (-1 to +1)\n    mouse.x = (dragCoords.x / dragCoords.width) * 2 - 1;\n    mouse.y = -(dragCoords.y / dragCoords.height) * 2 + 1;\n\n    raycaster.setFromCamera(mouse, camera);\n    \n    // Raycast to the floor plane\n    if (raycaster.ray.intersectPlane(plane, intersectPoint)) {\n        const pctX = xToPercent(intersectPoint.x);\n        const pctY = zToPercent(intersectPoint.z);\n        \n        // Return raw 0-100 coords. \n        const clampedX = Math.max(0, Math.min(100, pctX));\n        const clampedY = Math.max(0, Math.min(100, pctY));\n        \n        onUpdate(clampedX, clampedY);\n    }\n  }, [dragCoords, camera, raycaster, onUpdate]);\n\n  return null;\n};\n\nexport const StagePlotCanvas: React.FC<StagePlotCanvasProps> = ({\n  items,\n  setItems,\n  editable,\n  viewMode = 'isometric',\n  showAudienceLabel = true,\n  isPreview = false,\n  ghostItems = [],\n  dragCoords,\n  onDragPosChange,\n  members,\n  rotatingItemId,\n  onRotateItem,\n  onScreenshot: onScreenshotProp\n}) => {\n  const [activeId, setActiveId] = useState<string | null>(null);\n  const [rotationUiItemId, setRotationUiItemId] = useState<string | null>(null);\n  const [resizingItemId, setResizingItemId] = useState<string | null>(null);\n  const resizingItemIdRef = useRef<string | null>(null);\n  const [screenshotUrl, setScreenshotUrl] = useState<string | null>(null);\n\n  const handleScreenshot = (dataUrl: string) => {\n    setScreenshotUrl(dataUrl);\n    onScreenshotProp?.(dataUrl);\n  };\n  const dragOffset = useRef<{ x: number, z: number }>({ x: 0, z: 0 });\n\n  // Keep ref in sync so the DOM listener can read the current resizingItemId without stale closure\n  useEffect(() => {\n    resizingItemIdRef.current = resizingItemId;\n  }, [resizingItemId]);\n\n  // Stop resize on any native pointerdown in the canvas container (fires even when THREE.js\n  // stopPropagation prevents the floor-plane mesh from receiving the event)\n  useEffect(() => {\n    if (!resizingItemId) return;\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handlePointerDown = () => {\n      const prev = resizingItemIdRef.current;\n      setResizingItemId(null);\n      if (prev) setRotationUiItemId(prev);\n    };\n\n    // Delay by one frame so the \"Resize\" button's own pointerdown doesn't immediately cancel\n    const raf = requestAnimationFrame(() => {\n      container.addEventListener('pointerdown', handlePointerDown);\n    });\n\n    return () => {\n      cancelAnimationFrame(raf);\n      container.removeEventListener('pointerdown', handlePointerDown);\n    };\n  }, [resizingItemId]);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const handleDeleteItem = (id: string) => {\n    setItems(items.filter(i => i.id !== id));\n    setRotationUiItemId(null);\n  };\n\n  const handleQuantityChange = (id: string, quantity: number) => {\n    setItems(items.map(i =>\n      i.id === id ? { ...i, quantity } : i\n    ));\n  };\n\n  const handleMonitorNumberChange = (id: string, monitorNumber: number) => {\n    setItems(items.map(i =>\n      i.id === id ? { ...i, monitorNumber } : i\n    ));\n  };\n\n  const handleLabelChange = (id: string, label: string) => {\n    setItems(items.map(i => i.id === id ? { ...i, label } : i));\n  };\n\n  const handleResizeStart = (id: string) => {\n    setResizingItemId(id);\n    setRotationUiItemId(null);\n  };\n\n  const handleHeightChange = (id: string, height: number) => {\n    setItems(items.map(i => i.id === id ? { ...i, customHeight: Math.max(0.1, height) } : i));\n  };\n\n  const handleLabelHeightChange = (id: string, height: number) => {\n    setItems(items.map(i => i.id === id ? { ...i, labelHeight: Math.max(0.1, height) } : i));\n  };\n\n  const handlePointerDown = (e: ThreeEvent<PointerEvent>, id: string) => {\n    if (!editable) return;\n    // While in resize mode, don't start a drag — the DOM listener handles stopping resize\n    if (resizingItemId) return;\n    e.stopPropagation();\n    \n    const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\n    const pointOnPlane = new THREE.Vector3();\n    e.ray.intersectPlane(plane, pointOnPlane);\n    \n    const item = items.find(i => i.id === id);\n    if (item) {\n        const currentX = percentToX(item.x);\n        const currentZ = percentToZ(item.y);\n        dragOffset.current = {\n            x: currentX - pointOnPlane.x,\n            z: currentZ - pointOnPlane.z\n        };\n    }\n    setActiveId(id);\n  };\n\n  const handlePointerUp = (e: ThreeEvent<PointerEvent>) => {\n    if (!editable) return;\n    setActiveId(null);\n    dragOffset.current = { x: 0, z: 0 };\n  };\n\n  const handlePlaneMove = (e: ThreeEvent<PointerEvent>) => {\n    if (!editable) return;\n\n    if (resizingItemId) {\n      const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\n      const pointOnPlane = new THREE.Vector3();\n      e.ray.intersectPlane(plane, pointOnPlane);\n      const item = items.find(i => i.id === resizingItemId);\n      if (item) {\n        const itemWorldX = percentToX(item.x);\n        const itemWorldZ = percentToZ(item.y);\n        const newWidth = Math.max(0.3, Math.abs(pointOnPlane.x - itemWorldX) * 2);\n        const newDepth = Math.max(0.3, Math.abs(pointOnPlane.z - itemWorldZ) * 2);\n        setItems(items.map(i => i.id === resizingItemId\n          ? { ...i, customWidth: newWidth, customDepth: newDepth } : i));\n      }\n      return;\n    }\n\n    if (!activeId) return;\n    e.stopPropagation();\n    \n    const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\n    const pointOnPlane = new THREE.Vector3();\n    e.ray.intersectPlane(plane, pointOnPlane);\n\n    const targetWorldX = pointOnPlane.x + dragOffset.current.x;\n    const targetWorldZ = pointOnPlane.z + dragOffset.current.z;\n\n    // Get item dimensions to enforce boundaries\n    const item = items.find(i => i.id === activeId);\n    if (item) {\n        const config = getItemConfig(item);\n        const halfWidth = config.width / 2;\n        const halfDepth = config.depth / 2;\n\n        // Determine visual offset (must match StageDraggableItem logic)\n        let offset = [0, 0, 0];\n        const labelLower = (item.label || '').toLowerCase();\n        \n        if (config.shape !== 'person') {\n            if (labelLower.includes('drum') || labelLower.includes('kit')) {\n                offset = MODEL_OFFSETS.DRUMS;\n            } else if (labelLower.includes('sax')) {\n                offset = MODEL_OFFSETS.SAX;\n            } else if (labelLower.includes('trumpet') || labelLower.includes('tpt')) {\n                offset = MODEL_OFFSETS.TRUMPET;\n            }\n        }\n        const [offX, _offY, offZ] = offset;\n\n        // Boundaries (World Coordinates)\n        // We adjust bounds by the offset so the VISUAL mesh stays inside stage.\n        // minX = Left Edge + Half Width - X Offset\n        // maxX = Right Edge - Half Width - X Offset\n        \n        const minX = -(STAGE_WIDTH / 2) + halfWidth - offX;\n        const maxX = (STAGE_WIDTH / 2) - halfWidth - offX;\n        const minZ = -(STAGE_DEPTH / 2) + halfDepth - offZ;\n        const maxZ = (STAGE_DEPTH / 2) - halfDepth - offZ;\n\n        // Clamp\n        const clampedWorldX = Math.max(minX, Math.min(maxX, targetWorldX));\n        const clampedWorldZ = Math.max(minZ, Math.min(maxZ, targetWorldZ));\n\n        const newX = xToPercent(clampedWorldX);\n        const newY = zToPercent(clampedWorldZ);\n\n        setItems(items.map(i => \n            i.id === activeId \n                ? { ...i, x: newX, y: newY } \n                : i\n        ));\n    }\n  };\n\n  const isTopView = viewMode === 'top';\n  const camPosition: [number, number, number] = isTopView ? [0, 70, -1] : [-20, 30, 20];\n\n  // Responsive font sizes for audience label\n  const baseAudienceFontSize = 0.5; // Smaller for audience\n  const audienceFontSize = baseAudienceFontSize * (isPreview ? AUDIENCE_TEXT_FONT_SCALE_PREVIEW : AUDIENCE_TEXT_FONT_SCALE_INTERACTIVE);\n\n  // For preview with screenshot, show static image instead of threejs canvas\n  if (isPreview && screenshotUrl) {\n    return (\n      <div\n        className=\"w-full h-full bg-slate-50 overflow-hidden border-2 border-slate-300 print:border-black shadow-inner relative select-none\"\n        style={{ touchAction: 'none' }}\n      >\n        <img\n          src={screenshotUrl}\n          alt=\"Stage plot\"\n          className=\"w-full h-full object-contain\"\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div\n      ref={containerRef}\n      className=\"w-full h-full bg-slate-50 overflow-hidden border-2 border-slate-300 print:border-black shadow-inner relative select-none\"\n      style={{ touchAction: 'none', cursor: resizingItemId ? 'crosshair' : undefined }}\n    >\n      <Canvas shadows gl={{ preserveDrawingBuffer: true, antialias: true }} className=\"w-full h-full\">\n        <OrthographicCamera\n            key={viewMode}\n            makeDefault\n            position={camPosition}\n            zoom={1}\n            near={-50}\n            far={200}\n        />\n\n        <ResponsiveCameraAdjuster isTopView={isTopView} isPreview={isPreview} />\n\n        <ambientLight intensity={.9} />\n        <directionalLight\n          position={[-10, 30, 20]}\n          intensity={1}\n          castShadow\n          shadow-mapSize={[2048, 2048]}\n          shadow-bias={0.01}\n        />\n        <directionalLight position={[10, 10, -10]} intensity={0.4} />\n\n        <group position={[0, 0, 0]}>\n          <StagePlatform />\n          <Grid \n            position={[0, 0.01, 0]} \n            args={[STAGE_WIDTH, STAGE_DEPTH]} \n            cellSize={1} \n            cellThickness={0.6} \n            cellColor=\"#cbd5e1\" \n            sectionSize={2} \n            sectionThickness={1} \n            sectionColor=\"#94a3b8\" \n            infiniteGrid={false}\n          />\n          \n          {showAudienceLabel && (\n            <Text\n              position={[0, 0.05, STAGE_DEPTH / 2 + 0.3]}\n              rotation={[-Math.PI / 2, 0, 0]}\n              fontSize={audienceFontSize}\n              color=\"#64748b\"\n              anchorX=\"center\"\n              anchorY=\"middle\"\n            >\n              AUDIENCE\n            </Text>\n          )}\n\n          <mesh \n            rotation={[-Math.PI / 2, 0, 0]} \n            position={[0, 0, 0]} \n            onPointerDown={() => {\n              if (resizingItemId !== null) {\n                const prev = resizingItemId;\n                setResizingItemId(null);\n                setRotationUiItemId(prev);\n                return;\n              }\n              setRotationUiItemId(null);\n            }}\n            onPointerMove={handlePlaneMove}\n            onPointerUp={handlePointerUp}\n          >\n            <planeGeometry args={[STAGE_WIDTH * 3, STAGE_DEPTH * 3]} />\n            <meshBasicMaterial visible={false} />\n          </mesh>\n\n          <ContactShadows position={[0, 0.02, 0]} opacity={0.2} scale={20} blur={10} far={2} color=\"#000000\" />\n        </group>\n\n        <Suspense fallback={null}>\n            {items.map((item) => (\n              <StageDraggableItem\n                key={item.id}\n                item={item}\n                activeId={activeId}\n                onDown={handlePointerDown}\n                onMove={handlePlaneMove}\n                onUp={handlePointerUp}\n                member={members?.find(m => m.id === item.memberId)}\n                isRotating={rotatingItemId === item.id}\n                showRotationUI={rotationUiItemId === item.id}\n                onRequestRotationUI={() => setRotationUiItemId(item.id)}\n                onCloseRotationUI={() => setRotationUiItemId(null)}\n                onRotate={onRotateItem}\n                onDelete={handleDeleteItem}\n                onQuantityChange={handleQuantityChange}\n                onMonitorNumberChange={handleMonitorNumberChange}\n                onLabelChange={handleLabelChange}\n                onHeightChange={handleHeightChange}\n                onLabelHeightChange={handleLabelHeightChange}\n                onResizeStart={handleResizeStart}\n                isEditable={editable}\n                viewMode={viewMode}\n                isPreview={isPreview}\n              />\n            ))}\n\n            {ghostItems.map((item) => (\n              <StageDraggableItem\n                key={item.id}\n                item={item}\n                activeId={null}\n                onDown={() => {}}\n                onMove={() => {}}\n                onUp={() => {}}\n                isGhost={true}\n                member={members?.find(m => m.id === item.memberId)}\n                isPreview={isPreview}\n              />\n            ))}\n        </Suspense>\n\n        {/* Logic to sync external drag (sidebar) with 3D world */}\n        {dragCoords && onDragPosChange && (\n            <ExternalDragHandler dragCoords={dragCoords} onUpdate={onDragPosChange} />\n        )}\n\n        {/* Capture screenshot for preview mode with fixed camera */}\n        {isPreview && (\n          <ScreenshotCapture isPreview={isPreview} containerRef={containerRef} onScreenshot={handleScreenshot} />\n        )}\n\n      </Canvas>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}}]
}